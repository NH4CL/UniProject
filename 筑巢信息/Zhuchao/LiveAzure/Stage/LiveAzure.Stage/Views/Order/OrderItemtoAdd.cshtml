@{
    Layout=null;
}
@model LiveAzure.Models.Order.OrderItem
<script src="@Url.Content("~/Scripts/jquery.validate.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")" type="text/javascript"></script>

@using (@Ajax.BeginForm("OrderItemAdd", "Order", new AjaxOptions { OnSuccess = "AddOrderItemSuccess" }))
{
@Html.ValidationSummary(true)
<table class="DIY_table" style="width:40%;left:30%">
        @Html.HiddenFor(model=>model.OnSkuID)
        @Html.HiddenFor(model=>model.SkuID)
    <tr>
        <th>
            @Html.Label(LiveAzure.Resource.Model.Order.OrderItem.Name)
        </th>
        <td>
            @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
        </td>
    </tr>
    <tr>
        <th>
            @Html.Label(LiveAzure.Resource.Model.Order.OrderItem.Quantity)
        </th>
        <td>
            @Html.EditorFor(model => model.Quantity)
            @ViewBag.StdUnit
            @Html.ValidationMessageFor(model => model.Quantity)
        </td>
    </tr>
    <tr>
        <th>
            @Html.Label(LiveAzure.Resource.Model.Order.OrderItem.ExecutePrice)
        </th>
        <td>
            @Html.EditorFor(model => model.ExecutePrice)
            @Html.ValidationMessageFor(model => model.ExecutePrice)
        </td>
    </tr>
    <tr>
        <th>
            @Html.Label(LiveAzure.Resource.Model.Order.OrderItem.MarketPrice)
        </th>
        <td>
            @Html.DisplayFor(model => model.MarketPrice)
            @Html.HiddenFor(model =>model.MarketPrice)
        </td>
    </tr>
    <tr>
        <th>
            @Html.Label(LiveAzure.Resource.Model.Order.OrderItem.SalePrice)
        </th>
        <td>
            @Html.DisplayFor(model => model.SalePrice)
            @Html.HiddenFor(model => model.SalePrice)
        </td>
    </tr>
    <tr>
        <th>
            @Html.Label(LiveAzure.Resource.Model.ModelBase.Remark)
        </th>
        <td>
            @Html.TextAreaFor(model => model.Remark)
            @Html.ValidationMessageFor(model => model.Remark)
        </td>
    </tr>
</table>
<div style="position:relative; left:30%">
    <input type="submit" value="@LiveAzure.Resource.Common.Submit" />
</div>
}
<script type="text/javascript">
    function AddOrderItemSuccess() {
        if ("@ViewBag.Isediting" == "False") {//是否是编辑状态
            $("#OrderItemGrid").trigger("reloadGrid");
            AddOrderItemPanel.CloseEditPanel();
            $.post("/Order/ShippingListShow", {}, function (data) {
                $("#ShippingBlock").html(data);
                refreshCashInformation();
            });
        }
        else {
            AddOrderItemPanel.CloseEditPanel();
            $.post('/Order/OrderEditInfo', {}, function (html) {
                $('#OrderEditInfoMainPage').html(html); 
            });
        }
    }
</script>